"use strict";(self.webpackChunkkeycloakify=self.webpackChunkkeycloakify||[]).push([[8837],{"./dist/login/pages/LoginPasskeysConditionalAuthenticate.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>LoginPasskeysConditionalAuthenticate});__webpack_require__("./node_modules/core-js/modules/es.object.assign.js"),__webpack_require__("./node_modules/core-js/modules/es.object.keys.js"),__webpack_require__("./node_modules/core-js/modules/es.array.map.js");var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),clsx=__webpack_require__("./dist/tools/clsx.js"),lib_kcClsx=__webpack_require__("./dist/login/lib/kcClsx.js"),useInsertScriptTags=__webpack_require__("./dist/tools/useInsertScriptTags.js"),assert=__webpack_require__("./dist/tools/assert.js");function LoginPasskeysConditionalAuthenticate(props){var _a,kcContext=props.kcContext,i18n=props.i18n,doUseDefaultCss=props.doUseDefaultCss,Template=props.Template,classes=props.classes,messagesPerField=kcContext.messagesPerField,login=kcContext.login,url=kcContext.url,usernameHidden=kcContext.usernameHidden,shouldDisplayAuthenticators=kcContext.shouldDisplayAuthenticators,authenticators=kcContext.authenticators,registrationDisabled=kcContext.registrationDisabled,realm=kcContext.realm,msg=i18n.msg,msgStr=i18n.msgStr,advancedMsg=i18n.advancedMsg,kcClsx=(0,lib_kcClsx.$)({doUseDefaultCss,classes}).kcClsx;return function useScript(params){var authButtonId=params.authButtonId,kcContext=params.kcContext,i18n=params.i18n,url=kcContext.url,isUserIdentified=kcContext.isUserIdentified,challenge=kcContext.challenge,userVerification=kcContext.userVerification,rpId=kcContext.rpId,createTimeout=kcContext.createTimeout,msgStr=i18n.msgStr,isFetchingTranslations=i18n.isFetchingTranslations,insertScriptTags=(0,useInsertScriptTags.m)({componentOrHookName:"LoginRecoveryAuthnCodeConfig",scriptTags:[{type:"module",textContent:function textContent(){return'\n                    import { authenticateByWebAuthn } from "'+url.resourcesPath+'/js/webauthnAuthenticate.js";\n                    import { initAuthenticate } from "'+url.resourcesPath+'/js/passkeysConditionalAuth.js";\n\n                    const authButton = document.getElementById("'+authButtonId+'");\n                    const input = {\n                        isUserIdentified : '+isUserIdentified+",\n                        challenge : "+JSON.stringify(challenge)+",\n                        userVerification : "+JSON.stringify(userVerification)+",\n                        rpId : "+JSON.stringify(rpId)+",\n                        createTimeout : "+createTimeout+'\n                    };\n                    authButton.addEventListener("click", () => {\n                        authenticateByWebAuthn({\n                            ...input,\n                            errmsg : '+JSON.stringify(msgStr("webauthn-unsupported-browser-text"))+"\n                        });\n                    });\n\n                    initAuthenticate({\n                        ...input,\n                        errmsg : "+JSON.stringify(msgStr("passkey-unsupported-browser-text"))+"\n                    });\n                "}}]}).insertScriptTags;(0,react.useEffect)((function(){isFetchingTranslations||insertScriptTags()}),[isFetchingTranslations])}({authButtonId:"authenticateWebAuthnButton",kcContext,i18n}),(0,jsx_runtime.jsxs)(Template,Object.assign({kcContext,i18n,doUseDefaultCss,classes,headerNode:msg("passkey-login-title"),infoNode:realm.registrationAllowed&&!registrationDisabled&&(0,jsx_runtime.jsx)("div",Object.assign({id:"kc-registration"},{children:(0,jsx_runtime.jsxs)("span",{children:["$",msg("noAccount")," ",(0,jsx_runtime.jsx)("a",Object.assign({tabIndex:6,href:url.registrationUrl},{children:msg("doRegister")}))]})}))},{children:[(0,jsx_runtime.jsxs)("form",Object.assign({id:"webauth",action:url.loginAction,method:"post"},{children:[(0,jsx_runtime.jsx)("input",{type:"hidden",id:"clientDataJSON",name:"clientDataJSON"}),(0,jsx_runtime.jsx)("input",{type:"hidden",id:"authenticatorData",name:"authenticatorData"}),(0,jsx_runtime.jsx)("input",{type:"hidden",id:"signature",name:"signature"}),(0,jsx_runtime.jsx)("input",{type:"hidden",id:"credentialId",name:"credentialId"}),(0,jsx_runtime.jsx)("input",{type:"hidden",id:"userHandle",name:"userHandle"}),(0,jsx_runtime.jsx)("input",{type:"hidden",id:"error",name:"error"})]})),(0,jsx_runtime.jsx)("div",Object.assign({className:kcClsx("kcFormGroupClass"),"no-bottom-margin":"true",style:{marginBottom:0}},{children:void 0!==authenticators&&0!==Object.keys(authenticators).length&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("form",Object.assign({id:"authn_select",className:kcClsx("kcFormClass")},{children:authenticators.authenticators.map((function(authenticator,i){return(0,jsx_runtime.jsx)("input",{type:"hidden",name:"authn_use_chk",readOnly:!0,value:authenticator.credentialId},i)}))})),shouldDisplayAuthenticators&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[authenticators.authenticators.length>1&&(0,jsx_runtime.jsx)("p",Object.assign({className:kcClsx("kcSelectAuthListItemTitle")},{children:msg("passkey-available-authenticators")})),(0,jsx_runtime.jsx)("div",Object.assign({className:kcClsx("kcFormClass")},{children:authenticators.authenticators.map((function(authenticator,i){return(0,jsx_runtime.jsxs)("div",Object.assign({id:"kc-webauthn-authenticator-item-"+i,className:kcClsx("kcSelectAuthListItemClass")},{children:[(0,jsx_runtime.jsx)("i",{className:(0,clsx.W)((className=kcClsx(authenticator.transports.iconClass),className===authenticator.transports.iconClass?kcClsx("kcWebAuthnDefaultIcon"):className),kcClsx("kcSelectAuthListItemIconPropertyClass"))}),(0,jsx_runtime.jsxs)("div",Object.assign({className:kcClsx("kcSelectAuthListItemBodyClass")},{children:[(0,jsx_runtime.jsx)("div",Object.assign({id:"kc-webauthn-authenticator-label-"+i,className:kcClsx("kcSelectAuthListItemHeadingClass")},{children:advancedMsg(authenticator.label)})),void 0!==authenticator.transports&&void 0!==authenticator.transports.displayNameProperties&&0!==authenticator.transports.displayNameProperties.length&&(0,jsx_runtime.jsx)("div",Object.assign({id:"kc-webauthn-authenticator-transport-"+i,className:kcClsx("kcSelectAuthListItemDescriptionClass")},{children:authenticator.transports.displayNameProperties.map((function(nameProperty,i,arr){return(0,jsx_runtime.jsxs)(react.Fragment,{children:[(0,jsx_runtime.jsxs)("span",{children:[" ",advancedMsg(nameProperty)," "]},i),i!==arr.length-1&&(0,jsx_runtime.jsx)("span",{children:", "})]},i)}))})),(0,jsx_runtime.jsxs)("div",Object.assign({className:kcClsx("kcSelectAuthListItemDescriptionClass")},{children:[(0,jsx_runtime.jsx)("span",Object.assign({id:"kc-webauthn-authenticator-createdlabel-"+i},{children:msg("passkey-createdAt-label")})),(0,jsx_runtime.jsx)("span",Object.assign({id:"kc-webauthn-authenticator-created-"+i},{children:authenticator.createdAt}))]}))]})),(0,jsx_runtime.jsx)("div",{className:kcClsx("kcSelectAuthListItemFillClass")})]}),i);var className}))}))]}),(0,jsx_runtime.jsx)("div",Object.assign({id:"kc-form"},{children:(0,jsx_runtime.jsxs)("div",Object.assign({id:"kc-form-wrapper"},{children:[realm.password&&(0,jsx_runtime.jsx)("form",Object.assign({id:"kc-form-passkey",action:url.loginAction,method:"post",style:{display:"none"},onSubmit:function onSubmit(event){try{event.target.login.disabled=!0}catch(_a){}return!0}},{children:!usernameHidden&&(0,jsx_runtime.jsxs)("div",Object.assign({className:kcClsx("kcFormGroupClass")},{children:[(0,jsx_runtime.jsx)("label",Object.assign({htmlFor:"username",className:kcClsx("kcLabelClass")},{children:msg("passkey-autofill-select")})),(0,jsx_runtime.jsx)("input",{tabIndex:1,id:"username","aria-invalid":messagesPerField.existsError("username"),className:kcClsx("kcInputClass"),name:"username",defaultValue:null!==(_a=login.username)&&void 0!==_a?_a:"",type:"text",autoFocus:!0,autoComplete:"off"}),messagesPerField.existsError("username")&&(0,jsx_runtime.jsx)("span",Object.assign({id:"input-error-username",className:kcClsx("kcInputErrorMessageClass"),"aria-live":"polite"},{children:messagesPerField.get("username")}))]}))})),(0,jsx_runtime.jsx)("div",Object.assign({id:"kc-form-passkey-button",className:kcClsx("kcFormButtonsClass"),style:{display:"none"}},{children:(0,jsx_runtime.jsx)("input",{id:"authenticateWebAuthnButton",type:"button",autoFocus:!0,value:msgStr("passkey-doAuthenticate"),className:kcClsx("kcButtonClass","kcButtonPrimaryClass","kcButtonBlockClass","kcButtonLargeClass")})}))]}))}))]})}))]}))}(0,assert.h)(),(0,assert.h)()}}]);